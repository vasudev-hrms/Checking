 var util = require("./util");
	var errorMessages=new Array();
 var isStopOnError=false;
  function wipeAccount(){
	var i = 0;
	var listStores = util.callApi("ListStores", null, null, errorMessages, isStopOnError);
	for (i = 0; i < listStores.result.stores.length; i++) {
	    if (listStores.result.stores[i].name != "LoadTestStore") {
	        var deleteStore = util.callApi("DeleteStore", {"apsdb.store": listStores.result.stores[i].name}, null, errorMessages, isStopOnError);
	    }
	}
	var listGroups = util.callApi("ListGroups", null, null, errorMessages, isStopOnError);
	for (i = 0; i < listGroups.result.groups.length; i++) {
	    var deleteGroup = util.callApi("DeleteGroup", {"groupName": listGroups.result.groups[i].name}, null, null, errorMessages, isStopOnError);
	}
	var listUsers = util.callApi("ListUsers", null, null, errorMessages, isStopOnError);
	for (i = 0; i < listUsers.result.users.length; i++) {
 	   var deleteUser = util.callApi("DeleteUser", {"login": listUsers.result.users[i].login}, null, null, errorMessages, isStopOnError);
	}
	var listDevices = util.callApi("ListDevices", null, null, errorMessages, isStopOnError);
	for (i = 0; i < listDevices.result.devices.length; i++) {
 	   var deleteDevice = util.callApi("DeleteDevice", {"id": listDevices.result.devices[i].id}, null, null, errorMessages, isStopOnError);
	}
	var listChannels = util.callApi("ListChannels", null, null, errorMessages, isStopOnError);
	for (i = 0; i < listChannels.result.channels.length; i++) {
  	  var deleteChannel = util.callApi("DeleteChannel", {"name": listChannels.result.channels[i].name}, null, null, errorMessages, isStopOnError);
	}
	//Delete all documents in SystemStore
	var documents = require("document");
	var store = documents.getInstance("SystemStore");
	var listDocuments = store.query({"query" : "key is not null", "fields" : "*"});
	for(i=0; i<listDocuments.result.documents.length; i++)
	    store.delete(listDocuments.result.documents[i].key);
//Delete local storage in SystemStore.
	for (var l in storage.local) {
	    delete storage.local[l];
	}
//Delete global storage in SystemStore.
	for (var g in storage.global) {
 	delete storage.global[g];
	}
	var saveConfiguration = apsdb.callApi("SaveConfiguration", {
   	 "apsdb.createSchemaACL": "",
  	 	 "apsdb.createScriptACL": "",
   	 "apsdb.sendEmailACL": "",
		 "apsdb.listScriptsACL": "",
  	     "apsdb.getScriptACL": "",
  	     "apsdb.defaultScriptExecutionACL": "",
   	 "apsdb.storageStore": "",
    	 "apsdb.defaultNotificationStore": "",
  	     "apsdb.defaultResponseType": "",
    	 "apsdb.disableSchemalessDocs": "true",
    	 "apsdb.optionalBindReferrer": "false",
   	 "apsdb.allowForce200ResponseStatus": "true",
    	 "apsdb.defaultTokenExpires": "1800",
   	 "apsdb.maximumTokenExpires": "86400",
  	     "apsdb.defaultTokenLifeTime": "7200",
   	 "apsdb.maximumTokenLifeTime": "604800",
   	 "apsdb.defaultRepositoryName": "",
   	 "apsdb.defaultRepositoryOwner": "",
   	 "apsdb.defaultRepositoryAccessToken": "",
   	 "apsdb.defaultRepositoryBranch": "",
  	     "apsdb.defaultRepositoryPath": "",
  	     "apsdb.backgroundJobStore": "",
   	 "apsdb.gitPurge": "",
   	 "apsdb.P3P": "",
  	     "apsdb.useOldScriptPermissions": "",
  	     "apsdb.accessControlAllowOrigin": "",
  	     "apsdb.accessControlAllowHeaders": ""
	   }, null);
			handleResponse(saveConfiguration, errorMessages, isStopOnError, "wipeAccount[saveConfiguration]");
}
